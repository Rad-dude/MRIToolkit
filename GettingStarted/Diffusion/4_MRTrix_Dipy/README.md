<p align="center">
<a href="https://github.com/delucaal/MRIToolkit"> 
<img src="../../../img/MRIToolkitLogo.png" height="150"/> 
 </a> 
 </p>

# MRIToolkit - Inter operability with MRtrix3 and Dipy [update 14-03-2020] 
MRIToolkit attempts to full compatibility with other tools such as [MRtrix3](www.mrtrix.org) and [Dipy](www.dipy.org). To follow, some examples of how the data can be exchanged among programs.

## Diffusion data
To export the data contained in an ExploreDTI-like .mat file (for example after preprocessing), run the following:
```matlab
EDTI.EDTI_Data_2_Nii('mat_file','sub-MRI_ses-1/dwi/sub-MRI_ses-1_dMRI_B2500_S15_MB2_v2_1_FP_denoised_MD_C_trafo.mat',...
'output',''sub-MRI_ses-1/dwi/preprocessed_data')
```
This will create a .nii(gz)/.bval/.bvec. 

## FOD
The FODs generated by the EDTI or SphericalDeconvolution class follow the spherical harmonics representation of ExploreDTI. 
To convert this file to the MRtrix3 format, type:
```matlab
SphericalDeconvolution.SH_2_SH('shcoeffs','GRL_deconv_CSD_FOD_scaled.nii',...
'basis_in','edti','basis_out','mrtrix','output',GRL_deconv_CSD_FOD_scaled_mrtrix.nii');
```
For Dipy:
```matlab
SphericalDeconvolution.SH_2_SH('shcoeffs','GRL_deconv_CSD_FOD_scaled.nii',...
'basis_in','edti','basis_out','dipy','output',GRL_deconv_CSD_FOD_scaled_mrtrix.nii');
```
The opposite is of course possible: FODs from Dipy or MRtrix can be imported with the same command by properly adjusting the *basis_in* / *basis_out* parameters.

## Tractography / Tracking files
By default, MRIToolkit generates .mat files containing the streamlines representation according to the ExploreDTI convention. MRIToolkit can currently convert between the own .mat format and MRtrix .tck, and viceversa. Support for VTK and .trk is ready and will soon be added.
To convert to tck, type:
```matlab
SphericalDeconvolution.ConvertTCKTractography2Mat('tck_file','mrtrix_tracking.tck','output','mrtrix_tracking.mat','nii_file','sub-MRI_ses-1_dMRI_B2500_S15_MB2_v2_1_FP_denoised_MD_C_trafo_FA.nii')
```
and viceversa:
```matlab
SphericalDeconvolution.ConvertTCKTractography2Mat('tck_file','mrtrix_tracking.tck','output','mrtrix_tracking.mat','nii_file','sub-MRI_ses-1_dMRI_B2500_S15_MB2_v2_1_FP_denoised_MD_C_trafo_FA.nii')
```
